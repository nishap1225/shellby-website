<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Shellby the Shell Shuffler</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="074f832c-bb2a-4328-a283-dbf2438d9ee6" class="page sans"><header><div class="page-header-icon undefined"><span class="icon">🦾</span></div><h1 class="page-title">Shellby the Shell Shuffler</h1></header><div class="page-body"><p id="1f3e03fb-5bb9-4df7-932d-8c57cbcb321a" class="">Kevin Oh, Nisha Prabhakar, Matthew Sahim, Reena Yuan</p><nav id="a5282e9e-7c8f-4206-ac8b-ad73c652d2c4" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#d15f5b69-f020-4ef2-a2a3-2c869294e3c5">1.  Introduction</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#a89afd88-66e8-46e6-8458-43e3074e86c4">2.  Design</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#342b2ec1-676b-4fcc-8bec-5662d4a89e4e">Guesser </a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#7b689dcf-67ad-493b-bc6b-c16c7bb18337">Shuffler </a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#b2752f92-c600-4af3-8d7a-7b92bbeddfb3">3.  Implementation</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#8eed2b63-e101-4dd2-9556-7de52c1fab67">4.  Results</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#95ce4716-8860-4d88-848a-32589bfd9d79">5.  Conclusion</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#5d1081b2-6ccd-4d62-a4ec-486ef1d1f5f1">6.  Team</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#7d5cf890-bc13-4d5c-90e6-4e05af404ed8">7.  Additional materials</a></div></nav><h2 id="d15f5b69-f020-4ef2-a2a3-2c869294e3c5" class="">1.  Introduction</h2><p id="861ccbd7-71cd-48b4-973f-86c87e011e1e" class="">Our goal was to build an interactive shell game with the Sawyer robot. The user can decide to play against the Sawyer as the shuffler or the guesser. Our ultimate goal was to have the shuffler and guesser win while playing against a human. Here is a video of the shell game being played:</p><figure id="3d1d9bc1-850e-4128-a327-83f15815a34f"><div class="source"><a href="videos/Untitled.mp4">https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a8d3595e-e30c-448a-8409-d18c12f18968/Untitled.mp4</a></div><figcaption>Video of shell game demonstration.</figcaption></figure><p id="f9693d58-44f8-40f3-bcfe-bc259ad63369" class="">
</p><p id="dcaba8f1-bcd8-4294-bd23-e0bdc272b86d" class="">Our implementation of the shell game includes a shuffler as well as a guesser. The shuffler shuffles the cups while maintaining the same original configuration/placement on the table. It is important that the bean is not seen and doesn’t slide out while shuffling. Keeping this specific orientation was a big challenge as we were working through the project. </p><p id="c9ee1c51-cd3c-4846-b011-28c7806e58e7" class="">The guesser detects when the shuffler has started and stopped shuffling and keeps track of which cup the bean is under. Difficult problems we faced in this part of the project include filtering out the unnecessary objects in the image, finding the center of each cup, and keeping track of the cup with the bean. This project interests us because we’re creating both sides of the game. It will also be interesting to see which &quot;player&quot; is more successful and to see how the players fare against a human player. </p><p id="dd1c0149-1be2-4588-98f3-981efef33961" class="">Overall, Shellby performed well in the task of playing the shell game, demonstrating its capabilities in computer vision and object manipulation. This shuffling and guessing technology has potential applications in a wide range of fields, from manufacturing and assembly to entertainment and gaming. In a shipping and handling situation, for example, the robot could move packages from a storage facility onto a truck, sensing where to stack within the constraints of the truck container. </p><p id="58dc3799-9d77-4a61-8040-7029b241061c" class="">Many of us already play games against computer players virtually, from video games to playing chess. It could be very fun for players to compete against a computer player in real life using a robot similar to Sawyer. For example, the picking and setting motions of the shuffler could be adapted to playing chess against a human. </p><h2 id="a89afd88-66e8-46e6-8458-43e3074e86c4" class="">2.  Design</h2><p id="8544c4a6-40b0-4989-93e9-9da52b3a0672" class="">Our project is divided into two independent parts: the shuffler and the guesser. The design criteria we considered for each subsystem are as follows: </p><h3 id="342b2ec1-676b-4fcc-8bec-5662d4a89e4e" class="">Guesser </h3><ul id="25087a1a-8084-4889-8f36-3663a37776d4" class="bulleted-list"><li style="list-style-type:disc">Detect the cups which will be moved and ignore everything else.</li></ul><ul id="37799f15-ab32-4586-b7e1-2f6a9d426444" class="bulleted-list"><li style="list-style-type:disc">Track the position of the cup containing the bean.</li></ul><ul id="7c3a9c53-3a4b-46bf-ae78-e606d66d4709" class="bulleted-list"><li style="list-style-type:disc">Output the final bean position (as coordinates and relative position) given the signal that the game has ended.</li></ul><p id="1cffd1b3-f46f-41de-ac1f-9b5c111d7363" class="">We decided to use computer vision using a commercial webcam. The webcam images the field of view containing the shuffling cups from directly above the cups; the computer vision program takes that image and separates and identifies the individual cups. We were able to go with this design due to the cups’ red color and outline being distinct from the rest of the background. However, this design choice does not directly identify the location of this cup in 3D space and heavily relies on the background and lighting, making it susceptible to poor lighting and interference from the cups being very close to each other. Due to the webcam’s ability to be deployed anywhere, simplicity, and wide availability, it is efficient and durable, with robustness heavily depending on the image processing software and the cups being used.</p><h3 id="7b689dcf-67ad-493b-bc6b-c16c7bb18337" class="">Shuffler </h3><ul id="ef2b855b-71b8-4155-9572-689a09b05e8c" class="bulleted-list"><li style="list-style-type:disc">Using the positions of the three cups: <ul id="1a242070-3de6-4c9e-9998-82553805b38c" class="bulleted-list"><li style="list-style-type:circle">Move the end effector to grab any desired cup.</li></ul><ul id="bb35c7b6-6746-48e8-826b-00c2d81b58c0" class="bulleted-list"><li style="list-style-type:circle">Slide the cup on the table in any direction with the end effector such that the rim of the cup maintains contact with the table.</li></ul><ul id="5ce27233-6997-4431-859c-719be02e3159" class="bulleted-list"><li style="list-style-type:circle">Perform multiple swaps in the same run.  </li></ul></li></ul><p id="81eb09ba-9a74-4bc9-8ac5-29853eb2e08b" class="">The shuffler uses pre-programmed movements in order to manipulate the cups. This allows for consistent paths but is not a flexible implementation as it requires the cups to start in the same position whenever the game is played. We use a gripper to physically manipulate the cups’ positions, grabbing the cup and dragging it to their destinations. Because of the gripper’s small size and simplicity, it is not only able to grab cups reliably but also be able to work with other objects as well. Also, due to it only having two contact points, it allows the cup to be in many different orientations while making contact with the work surface as the gripper drags it along.</p><h2 id="b2752f92-c600-4af3-8d7a-7b92bbeddfb3" class="">3.  Implementation</h2><p id="5183306d-4fd5-467c-a9f8-e1ed27f9a0b1" class="">The Sawyer robot arm used for this project is a state-of-the-art high-precision robotic manipulator with 7 joints and a gripper for picking up and moving objects. It was programmed with a controller for movement, an external camera with proprietary computer vision algorithms to track the cups, and ROS to wirelessly communicate with our computer. We also used RViz to visualize our paths before executing for safety.</p><p id="4c05ba7a-e991-4384-952f-355f990ae1fd" class="">The cameras used are the Logitech C922 webcams providing 1080p video feed at 30 fps. The camera responsible for the guesser was mounted directly above the three cups and pointed downward, plugged directly into the computer handling the software. Originally, the shuffler camera was mounted level with the cups and pointed such that the three cups and the robot base were contained in the field of view. However, our current implementation for the shuffler does not use a camera. k</p><p id="aed25743-7aaa-4e2d-94e2-5961a36164d0" class="">All the programming was done by our team with the ROS package in Python and the RViz software. RViz is a ROS graphical interface for viewing robot movements, AR tag positioning, and much more.</p><p id="7365d070-a4f0-4077-937f-48a7e35c2cea" class="">Here is a gif of RViz with the robot, AR tag markers, and obstacles shown:</p><figure id="337d6423-c21f-4fe2-a537-826a34808881" class="image"><a href="videos/rviz_plan.gif"><img style="width:1920px" src="videos/rviz_plan.gif"/></a></figure><p id="19220d7f-e05d-4ae8-be97-f47d0f9ac671" class="">
</p><p id="33e32804-9307-425c-bccd-941bb20fd261" class="">Below is the logic diagram for the guesser:</p><figure id="a3b1aed7-aad8-4e78-b3e6-a0698dbc6398" class="image"><a href="images/Untitled.png"><img style="width:384px" src="images/Untitled.png"/></a><figcaption>Image of Guesser logic tree.</figcaption></figure><p id="f403d3e8-dd63-4857-83ca-47b85e471ef1" class=""><strong>Guesser:</strong></p><p id="a342cec5-a000-485d-bf0a-a6dec48a39de" class="">The Guesser begins with the raw image received from the camera viewing the cups to be processed. </p><p id="b18a67d6-4c3b-4b24-bbeb-92912d74a8ff" class="">We then downsize the image from 1080p to 360p in order to allow the image processing to run quicker, then employ gaussian blur across the image reducing the details and effect from noise and other small details and defects present in the cups and environment.</p><p id="8415b18a-d944-458b-985e-b733a5caa70d" class="">Since we are using red solo cups, we distinguish them by masking out all non-red features. We accomplish this by passing only parts of the image that lie between specific RGB values that we determined through testing into the next step. In the end we have a mask image with white where the cups are present and black for everything else.</p><p id="cd892017-4b1a-4649-9dad-56e5001df408" class="">This mask is passed into findContour function in the OpenCV framework, which is an open-source library that includes several hundreds of computer vision algorithms. The contour outlines the blob of pixels that correspond to each cup and distinguishes the three cups from each other as well.</p><p id="18d98f48-4e71-43ad-bd7c-55bf736b3b75" class="">We ultimately obtain a single location of the cups by finding the centroid of each of contour given by the aforementioned findContour function and finding the moment and center of mass (a.k.a averaging out the x and y coordinates of the pixels). We also use filtering at this step due to the contour function returning multiple contours around a single object when we only need one. We accomplish this by defining an error region around each centroid and merging centroid that lie within each other’s region into one. This results in a single centroid identifying each of the three cups and a hand if is present in the field of view.</p><figure id="42902dda-736d-4b4c-b40a-36e25c870333" class="image"><a href="images/Untitled%201.png"><img style="width:1874px" src="images/Untitled%201.png"/></a><figcaption>Image of raw camera footage on left processed with masking and centroids on right in live time.</figcaption></figure><p id="ac4bf322-49f6-4062-9ac1-b21fa7885c41" class="">With the centroids found, we continuously loop through the camera images to follow the centroids as they move. By tracking their base position and using logic of which positions are moving, we can distinguish which cups are being shuffled. The logic compares the centroids from the previous iteration, first linking the centroids that have not moved to each other as a single object. Then the moving cup is identified by looking for the centroid closest to its previous position and updating the cup position with the correct centroid and not per se the hand centroid or a centroid resulting from noise. As the shuffler shuffles through the cups, the algorithm will follow the original cup with the bean inside to the end, and make its final guess once shuffling ends signaled by a keyboard interrupt.</p><figure id="9fc00df9-2b29-47e2-a22a-9a6c38e4705d" class="image"><a href="images/Untitled%202.png"><img style="width:528px" src="images/Untitled%202.png"/></a><figcaption>Image of Shuffler logic tree.</figcaption></figure><p id="8d5a70b2-f853-4c3f-9b4a-97a26232e0b8" class=""><strong><strong><strong><strong><strong><strong><strong><strong><strong>Shuffler:</strong></strong></strong></strong></strong></strong></strong></strong></strong>    </p><p id="22248ce8-0513-4301-b575-f4c8fe1a4c63" class="">The shuffler also begins with the raw image from the camera. Using the ar_tracker package and the AR tags being positioned on top of the cups, as well as run_cam.launch and ar_track.launch, we can get the TF transformations between the robot gripper and the cups. Since the robot gripper was a descendant the Sawyer’s tree and the AR markers were descendants of the camera’s tree, getting the transformation to the AR marker originally returned in the camera’s frame, which was incorrect because they needed to be in the Sawyer’s frame (also referred to as the ‘base’ frame). To resolve this issue, we had to combine the two isolated trees by placing an AR marker in the same location as the ‘base’ frame of the Sawyer. Then, we created a publisher node that repeatedly published the transformation from the AR marker to the ‘base’ frame to the ‘tf’ topic, making the base frame a child of the AR marker and descendant of the camera frame. After publishing this transformation and creating a relationship between the ‘base’ frame and camera frame, we could then retrieve transformations to the cups in the correct frame. </p><p id="0edb7f56-b698-4666-9d84-8aa560a55e21" class="">In order to prevent the robot gripper from hitting other cups or objects while moving, we had to add both cylindrical obstacles for the cups and box obstacles for the table and wall. Although we were able to correctly add these obstacles based on both measuring by hand and using the transformations of the AR tags, there was a lot of imprecision involved with using the MoveIt planning package. For example, the gripper’s motion often ended at a variable offset from the actual AR tag goal, and the package also ignored the position constraints we used to confine the movement of the gripper to be along a plane. In addition, the Sawyer arm often took very convoluted paths to grab and move the cups, which was not ideal especially due to the speed constraints of the Sawyer arm.</p><p id="fdf38fce-054c-46c5-80b9-0a99066882c8" class="">Since many of the software issues with MoveIt were out of our control, we pivoted post-presentation to using joint angles, which gave us much more control over the robot. Using inverse kinematics, we calculated a series of joint angles at small increments for each of our desired paths. For each set of seven joint angles corresponding to a gripper position, we pass in the set of angles to Sawyer to execute. We found this approach to be much more successful, since we could plan out each path exactly. Once we found the poses for certain intermediate positions that each path would go through, we were able to calculate for and execute a variety of paths. Since this method involved hardcoded positions, this version of the shuffler did not require a camera. </p><p id="b4a8f6d6-792a-4167-82e7-7bfcb9a4ac92" class="">(to delete?)The controller uses PID or proportionate-integral-derivative control to travel between its current position and its desired trajectory. The proportionate term describes the actual error between the current and desired position. The integral term accounts for constant system errors and inconsistencies within the robot itself. The derivative terms follow the rate of change of the gripper&#x27;s position to accelerate smoothly and slowly at the beginning and end of the robot’s movement. This is to prevent jerky behavior that would otherwise cause system instabilities.</p><p id="81c9eee0-90c3-4b00-b8f3-8eb83b7e19ce" class="">The file structure of the project can be seen on the GitHub repository and visualized by running “tree” in the repository terminal (too long to be attached here).</p><h2 id="8eed2b63-e101-4dd2-9556-7de52c1fab67" class="">4.  Results</h2><p id="28f3eb23-af72-48d6-b6d2-c72018f0f8b7" class="">Shellby was successfully able to move and shuffle the cups on the table as the shuffler. Shellby was also able to reliably track the cup given the information on which cup contains the bean after multiple shuffles.</p><p id="3783607d-251b-4323-93ea-e14319469384" class="">Overall, the robot arm performed well in the task of playing the shell game, demonstrating its capabilities in computer vision and object manipulation.</p><p id="0770cffd-47e1-4a77-a425-6d7c88151858" class="">Below is a screen capture of the Guesser following the cups being shuffled and correctly guessing the correct cup with the bean underneath. The Guesser can track any number of cups as shown with a video with 3 cups on the left, and 4 cups on the right. Running the Guesser program prompts the user to input how many cups there are and which cup the bean is under initially with zero indexing.</p><div id="b105af23-da40-4a59-a532-749727976f8a" class="column-list"><div id="23959693-4577-4a0c-960f-e90611f51ced" style="width:50%" class="column"><figure id="e433490c-1a6c-4ec5-833b-b44b34c8593e"><div class="source"><a href="videos/Untitled%201.mp4">https://s3-us-west-2.amazonaws.com/secure.notion-static.com/910081e1-b4c6-42c2-b2d8-18b595e426b0/Untitled.mp4</a></div><figcaption>Left: Guesser with 3 cups.</figcaption></figure></div><div id="6d576644-b973-4f44-964f-810d7df254d9" style="width:50%" class="column"><figure id="5ac4ecd4-7e10-4f6c-95fc-137f728e568e"><div class="source"><a href="videos/guesser_fourcups.mp4">https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c1a505a9-48b7-4610-b756-aedae352041b/guesser_fourcups.mp4</a></div><figcaption>Right: Guesser with 4 cups.</figcaption></figure></div></div><p id="97e752dc-7065-42e2-90ee-8d4323e198e0" class="">Below are videos of the Shuffler performing varying numbers of shuffles:</p><div id="7ba862ba-c57b-4551-a033-9fa57b3542d3" class="column-list"><div id="99c5c748-d0da-48dd-bf69-e3f243a118a7" style="width:50%" class="column"><figure id="4e75a794-4d43-4a7a-8956-60117d38dbc2"><div class="source"><a href="videos/Untitled%202.mp4">https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6564bbb5-27aa-47d6-a302-f9a892f55897/Untitled.mp4</a></div><figcaption>Video of Shuffler performing 1 shuffle.</figcaption></figure></div><div id="a70fc5b2-06fe-41b4-ba1e-51f0d218e719" style="width:50%" class="column"><figure id="275d5c1d-db8b-496c-832c-88318c4ea708"><div class="source"><a href="videos/Untitled%203.mp4">https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4fc2812c-c285-4f8a-a063-4fd115e21092/Untitled.mp4</a></div><figcaption>Video of Shuffler performing 2 shuffles consecutively.</figcaption></figure></div></div><p id="a8373679-1b88-47a8-8885-7a54fd9123a7" class="">The Shuffler can even get creative with shuffling by moving a cup and back without exchanging positions with another cup as shown:</p><figure id="6c010740-0640-4b24-862b-c2d6a355ca5c"><div class="source"><a href="videos/Untitled%204.mp4">https://s3-us-west-2.amazonaws.com/secure.notion-static.com/be2b02a7-1fee-45cf-816e-26a1220eeb8a/Untitled.mp4</a></div><figcaption>Video of Shuffler performing a fake followed by 2 shuffles.</figcaption></figure><h2 id="95ce4716-8860-4d88-848a-32589bfd9d79" class="">5.  Conclusion</h2><p id="70b70b97-82c3-4c5a-8a23-911da0629b8c" class="">Shellby’s guesser aspect was able to meet the design criteria as we specified, being able to detect, track, and output the position of the cup containing the bean. We did have difficulty with the filtering part of the image processing as we had to use primarily trial and error in order to get a RGB value interval that ignored anything other than cups, and that interval changed with lighting and camera. We did consider a more complex solution that filtered pixels that had a higher G and B value compared to the R value, but the solution was computationally taxing and slowed down the image processing to the point where it interfered with the tracking ability.</p><p id="ca74304b-d387-4198-b40e-2dcdd5ad6a9e" class="">Shellby’s shuffler aspect ultimately wasn’t able to meet the first design criteria of identifying the relative positions of the cup, camera, and robot base. We initially attempted a vision based solution using AR tracking with AR tags located on the cups and base of the robot, but the inaccuracies and noise involved with identifying AR tags too small at too far of a distance led to significant reliability issues that impacted our ability to demonstrate a valid shuffler. Because of this we converted to a hard-coded solution where the robot is given the cup positions and plans its motion accordingly. This unfortunately leads to our solution failing whenever the cups are misaligned from their designated position. We also struggled significantly with motion planning, position and orientation constraints required by the design criteria often not working as intended and often planned extremely inefficient paths.</p><p id="dc576a8d-1205-45f5-97e9-3cd840b59c34" class="">Improvements we would have liked to have made include a different vision based solution where the camera based on the robot’s end effector is used as it eliminates the error associated with extrapolating the transformation between the external camera and the base of the robot (since the robot’s end effector position can be accurately derived from the joint position) with AR tags. We also considered motion planning each step of the shuffling multiple times and select the best path using criteria such as total end effector travel distance or joint angle change.</p><h2 id="5d1081b2-6ccd-4d62-a4ec-486ef1d1f5f1" class="">6.  Team</h2><p id="75066408-7ab0-429f-962f-4c38971be197" class="">Nisha Prabhakar is an EECS major interested in machine learning and computer vision. She worked on both the guesser and shuffler side.</p><p id="1eb25421-39c0-430a-850f-159bce388235" class="">Kevin Oh is a mechanical engineering major with prior robotics experience. He worked on the guesser side, responsible for the image filtering and the cup tracking logic.</p><p id="64423ec4-c26f-4bc4-b237-fff01a2cacae" class="">Matthew Sahim is a nuclear engineering major with research and technical project experience. He worked on the shuffler side, primarily on the controller and movement logic.</p><p id="828416c9-fdf3-4677-bf05-8f03dd94b5f8" class="">Reena Yuan is an EECS major with software engineering experience from a variety of companies. She worked on the shuffler side, primarily on tracking the poses between gripper and the AR tags on the cups.</p><h2 id="7d5cf890-bc13-4d5c-90e6-4e05af404ed8" class="">7.  Additional materials</h2><p id="4a1e6e98-79ce-4ac4-9629-c4d31a84dc7a" class="">The GitHub repository is where all the code is stored: <a href="https://github.com/nishap1225/shellby">https://github.com/nishap1225/shellby</a> <a href="https://github.com/nishap1225/shellby">https://github.com/nishap1225/shellby</a></p><p id="b99325a6-4248-4b7a-a92c-bd1fcb4e25f8" class="">This website can be accessed by: </p><figure id="3ba2b8d7-8f7a-4470-994a-90c2aae6f235"><a href="https://nishap1225.github.io/shellby-website/" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">Shellby the Shell Shuffler</div><div class="bookmark-description">The goal of our project was to build an interactive shell game with the Sawyer robot. The user can decide to play against the Sawyer as the shuffler or guesser, or have 2 Sawyers play against each other. Our ultimate goal was to have the shuffler and guesser win while playing against a human.</div></div><div class="bookmark-href">https://nishap1225.github.io/shellby-website/</div></div></a></figure><p id="35b87dca-b1bb-482d-bf06-5356a012335e" class="">
</p></div></article></body></html>
